
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Preparación de base google trends &#8212; Proyecto Data Science</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Proyecto Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown-notebooks.html">
   Notebooks with MyST Markdown
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/1_1_googleTrends.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F1_1_googleTrends.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/1_1_googleTrends.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Preparación de base google trends</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="preparacion-de-base-google-trends">
<h1>Preparación de base google trends<a class="headerlink" href="#preparacion-de-base-google-trends" title="Permalink to this headline">#</a></h1>
<p>Para armar la solicitud de términos de búsqueda se utiliza la librería <code class="docutils literal notranslate"><span class="pre">pytrends</span></code>, cuya forma de utilización se puede encontrar en <a class="reference external" href="https://hackernoon.com/how-to-use-google-trends-api-with-python"><em><strong>hackernoon</strong></em></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install pytrends # install google trends API
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting pytrends
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading pytrends-4.8.0.tar.gz (19 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Preparing metadata (setup.py) ... ?25l- done
?25hRequirement already satisfied: requests&gt;=2.0 in /Users/antonellabulla/opt/miniconda3/lib/python3.9/site-packages (from pytrends) (2.27.1)
Requirement already satisfied: pandas&gt;=0.25 in /Users/antonellabulla/opt/miniconda3/lib/python3.9/site-packages (from pytrends) (1.4.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting lxml
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading lxml-4.9.1-cp39-cp39-macosx_10_15_x86_64.whl (4.6 MB)
?25l     <span class=" -Color -Color-C237">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">0.0/4.6 MB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ╸<span class=" -Color -Color-C237">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">0.1/4.6 MB</span> <span class=" -Color -Color-Red">3.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:02</span>
     ━━<span class=" -Color -Color-C237">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">0.2/4.6 MB</span> <span class=" -Color -Color-Red">3.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:02</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━╸<span class=" -Color -Color-C237">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">0.5/4.6 MB</span> <span class=" -Color -Color-Red">4.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━<span class=" -Color -Color-C237">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">0.9/4.6 MB</span> <span class=" -Color -Color-Red">5.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━╸<span class=" -Color -Color-C237">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">1.3/4.6 MB</span> <span class=" -Color -Color-Red">6.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
     ━━━━━━━━━━━━━━<span class=" -Color -Color-C237">╺━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">1.7/4.6 MB</span> <span class=" -Color -Color-Red">6.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━<span class=" -Color -Color-C237">╺━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">2.1/4.6 MB</span> <span class=" -Color -Color-Red">7.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━<span class=" -Color -Color-C237">╺━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">2.4/4.6 MB</span> <span class=" -Color -Color-Red">7.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━╸<span class=" -Color -Color-C237">━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">2.9/4.6 MB</span> <span class=" -Color -Color-Red">7.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━<span class=" -Color -Color-C237">╺━━━━━━━━━━</span> <span class=" -Color -Color-Green">3.4/4.6 MB</span> <span class=" -Color -Color-Red">8.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━<span class=" -Color -Color-C237">╺━━━━━━━</span> <span class=" -Color -Color-Green">3.7/4.6 MB</span> <span class=" -Color -Color-Red">8.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━<span class=" -Color -Color-C237">╺━━━</span> <span class=" -Color -Color-Green">4.1/4.6 MB</span> <span class=" -Color -Color-Red">8.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸<span class=" -Color -Color-C237">━</span> <span class=" -Color -Color-Green">4.4/4.6 MB</span> <span class=" -Color -Color-Red">8.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸ <span class=" -Color -Color-Green">4.6/4.6 MB</span> <span class=" -Color -Color-Red">8.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     <span class=" -Color -Color-Red">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">4.6/4.6 MB</span> <span class=" -Color -Color-Red">7.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25h
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: numpy&gt;=1.18.5 in /Users/antonellabulla/opt/miniconda3/lib/python3.9/site-packages (from pandas&gt;=0.25-&gt;pytrends) (1.22.3)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in /Users/antonellabulla/opt/miniconda3/lib/python3.9/site-packages (from pandas&gt;=0.25-&gt;pytrends) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /Users/antonellabulla/opt/miniconda3/lib/python3.9/site-packages (from pandas&gt;=0.25-&gt;pytrends) (2021.3)
Requirement already satisfied: charset-normalizer~=2.0.0 in /Users/antonellabulla/opt/miniconda3/lib/python3.9/site-packages (from requests&gt;=2.0-&gt;pytrends) (2.0.4)
Requirement already satisfied: certifi&gt;=2017.4.17 in /Users/antonellabulla/opt/miniconda3/lib/python3.9/site-packages (from requests&gt;=2.0-&gt;pytrends) (2021.10.8)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /Users/antonellabulla/opt/miniconda3/lib/python3.9/site-packages (from requests&gt;=2.0-&gt;pytrends) (1.26.7)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Users/antonellabulla/opt/miniconda3/lib/python3.9/site-packages (from requests&gt;=2.0-&gt;pytrends) (3.3)
Requirement already satisfied: six&gt;=1.5 in /Users/antonellabulla/opt/miniconda3/lib/python3.9/site-packages (from python-dateutil&gt;=2.8.1-&gt;pandas&gt;=0.25-&gt;pytrends) (1.16.0)
Building wheels for collected packages: pytrends
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Building wheel for pytrends (setup.py) ... ?25l-
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> done
?25h  Created wheel for pytrends: filename=pytrends-4.8.0-py3-none-any.whl size=16126 sha256=25397ad28d10cc1b0dc5a926ca70f72949153d8995479d0736dd3116a03cb55c
  Stored in directory: /Users/antonellabulla/Library/Caches/pip/wheels/87/a9/a3/c190a7e0872639762e92cf3a84d6845ed086e10966533faf42
Successfully built pytrends
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing collected packages: lxml, pytrends
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Successfully installed lxml-4.9.1 pytrends-4.8.0
<span class=" -Color -Color-Yellow">WARNING: You are using pip version 22.0.4; however, version 22.2 is available.</span>
<span class=" -Color -Color-Yellow">You should consider upgrading via the &#39;/Users/antonellabulla/opt/miniconda3/bin/python -m pip install --upgrade pip&#39; command.</span>

</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span><span class="p">,</span> <span class="n">reduce</span> <span class="c1"># to transform variable dic in a dataframe  </span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">daily_gt</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">inputCategories</span> <span class="p">,</span><span class="n">inputCategoriesNames</span> <span class="p">,</span> <span class="n">hl</span><span class="o">=</span><span class="s1">&#39;en-US&#39;</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="mi">360</span><span class="p">):</span>
  <span class="kn">import</span> <span class="nn">time</span>
  <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
  <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># numpy y pandas to data wrangling </span>
  <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span> <span class="c1"># to work w date</span>
  <span class="kn">from</span> <span class="nn">pytrends.request</span> <span class="kn">import</span> <span class="n">TrendReq</span>
  <span class="c1"># función para dividir rango de fechas en segmentos </span>
  <span class="k">def</span> <span class="nf">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">intv</span><span class="p">):</span>
      <span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">end</span><span class="p">,</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="n">diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span>  <span class="o">-</span> <span class="n">start</span> <span class="p">)</span> <span class="o">/</span> <span class="n">intv</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">intv</span><span class="p">):</span>
          <span class="k">yield</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">diff</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="k">yield</span> <span class="n">end</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

  <span class="c1"># set pytrends para region y zona horaria</span>
  <span class="n">pytrends</span> <span class="o">=</span> <span class="n">TrendReq</span><span class="p">(</span><span class="n">hl</span><span class="o">=</span><span class="n">hl</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span> 

  <span class="c1"># generación de lista de fechas a utilizar</span>
  <span class="n">firstDate</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="n">lastDate</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">end</span><span class="p">,</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="n">diffDays_control</span> <span class="o">=</span> <span class="n">lastDate</span> <span class="o">-</span> <span class="n">firstDate</span> 
  <span class="k">if</span>  <span class="n">diffDays_control</span><span class="o">.</span><span class="n">days</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">:</span>
    <span class="n">aux</span> <span class="o">=</span> <span class="p">(</span><span class="n">lastDate</span> <span class="o">-</span> <span class="n">firstDate</span><span class="p">)</span><span class="o">/</span><span class="mi">90</span>
    <span class="n">intv</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">days</span>
    <span class="n">timelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">intv</span><span class="p">))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">timelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">])</span>

  <span class="c1"># armamos lista vacía para guardar los resultados</span>
  <span class="n">var_dict</span><span class="o">=</span><span class="p">{}</span>

  <span class="c1"># loop de palabras o categorías a importar</span>
  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">keyword</span><span class="p">)):</span>
    <span class="n">varName</span> <span class="o">=</span> <span class="n">keyword</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">varName</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">varName</span><span class="p">])</span>
    <span class="c1"># loop de rango de fechas sobre cada palabra o categoría</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">timelist</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">timelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">start</span><span class="p">:</span>
        <span class="n">startAux</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">timelist</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">startNew</span> <span class="o">=</span> <span class="n">startAux</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">startAux</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">timelist</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">startNew</span> <span class="o">=</span> <span class="n">startAux</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Iteration from </span><span class="si">{</span><span class="n">startNew</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">timelist</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

      <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">varName</span><span class="p">)</span><span class="o">==</span><span class="nb">int</span><span class="p">:</span> <span class="c1"># para considerar las categorías por separado</span>
        <span class="n">pytrends</span><span class="o">.</span><span class="n">build_payload</span><span class="p">(</span><span class="n">kw_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">cat</span><span class="o">=</span><span class="n">varName</span><span class="p">,</span> <span class="n">timeframe</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">startNew</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">timelist</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
        <span class="n">data</span> <span class="o">=</span> <span class="n">pytrends</span><span class="o">.</span><span class="n">interest_over_time</span><span class="p">()</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="n">inputCategories</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">varName</span><span class="p">)</span>
        <span class="n">catName</span> <span class="o">=</span> <span class="n">inputCategoriesNames</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span> <span class="c1"># para renombrar columnas sin nombres en categorías</span>
        <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">catName</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

      <span class="k">else</span><span class="p">:</span>
        <span class="n">pytrends</span><span class="o">.</span><span class="n">build_payload</span><span class="p">(</span><span class="n">kw_list</span><span class="o">=</span><span class="p">[</span><span class="n">varName</span><span class="p">],</span> <span class="n">cat</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">timeframe</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">startNew</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">timelist</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
        <span class="n">data</span> <span class="o">=</span> <span class="n">pytrends</span><span class="o">.</span><span class="n">interest_over_time</span><span class="p">()</span>

      <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span> <span class="c1"># chequear que la base importada no esté vacía antes de trabajarla, sino pasar a la prox palabra</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;isPartial&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">))</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> 
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span> 
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">data</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># para aumentar el tiempo entre iteración para evitar el eror 429</span>
      <span class="k">else</span><span class="p">:</span> 
        <span class="k">continue</span>      
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">varName</span><span class="p">)</span><span class="o">==</span><span class="nb">int</span><span class="p">:</span>
      <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># elinamos la columna vacía que se genera por importar categorías que no coinciden con el nombre de la primer columna del dataset generado al ppio</span>
      <span class="n">pytrends</span><span class="o">.</span><span class="n">build_payload</span><span class="p">(</span><span class="n">kw_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">cat</span><span class="o">=</span><span class="n">varName</span><span class="p">,</span> <span class="n">timeframe</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span> 
      <span class="n">historical_data</span> <span class="o">=</span> <span class="n">pytrends</span><span class="o">.</span><span class="n">interest_over_time</span><span class="p">()</span>
      <span class="n">historical_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">catName</span><span class="si">}</span><span class="s1">_historical&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
      <span class="n">varName</span> <span class="o">=</span> <span class="n">catName</span> <span class="c1"># para que encuentre las columnas para hacer la normalización</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">pytrends</span><span class="o">.</span><span class="n">build_payload</span><span class="p">(</span><span class="n">kw_list</span><span class="o">=</span><span class="p">[</span><span class="n">varName</span><span class="p">],</span> <span class="n">cat</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">timeframe</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span> 
      <span class="n">historical_data</span> <span class="o">=</span> <span class="n">pytrends</span><span class="o">.</span><span class="n">interest_over_time</span><span class="p">()</span>
      <span class="n">historical_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">varName</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">varName</span><span class="si">}</span><span class="s1">_historical&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

    <span class="n">historical_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">historical_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;isPartial&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">))</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">historical_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">historical_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> 
      
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">historical_data</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">])</span>
    <span class="k">del</span> <span class="n">historical_data</span>
    <span class="n">dataset</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">varName</span><span class="si">}</span><span class="s1">_adjusted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">varName</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">varName</span><span class="si">}</span><span class="s1">_historical&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> 
    <span class="n">var_dict</span><span class="p">[</span><span class="n">varName</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">var_dict</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cryptocurrency&#39;</span><span class="p">,</span> <span class="s1">&#39;crypto&#39;</span><span class="p">,</span> <span class="s1">&#39;bitcoin&#39;</span><span class="p">,</span> <span class="s1">&#39;bitcoin price&#39;</span><span class="p">,</span> <span class="s1">&#39;ethereum&#39;</span><span class="p">,</span> <span class="s1">&#39;ethereum price&#39;</span><span class="p">]</span>
<span class="n">monetary</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;stock market&#39;</span><span class="p">,</span> <span class="s1">&#39;wall street&#39;</span><span class="p">,</span> <span class="s1">&#39;interest rate&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;bankruptcy&#39;</span><span class="p">]</span>
<span class="n">real</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;taxes&#39;</span><span class="p">,</span> <span class="s1">&#39;investment&#39;</span><span class="p">]</span>
<span class="n">policy</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;china&#39;</span><span class="p">,</span> <span class="s1">&#39;united states&#39;</span><span class="p">,</span> <span class="s1">&#39;war&#39;</span><span class="p">,</span> <span class="s1">&#39;russia&#39;</span><span class="p">]</span>
<span class="n">influencers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;elon musk&#39;</span><span class="p">,</span> <span class="s1">&#39;do kwon&#39;</span><span class="p">]</span>
<span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/m/0vpj4_b&#39;</span><span class="p">,</span> <span class="s1">&#39;/m/05p0rrx&#39;</span><span class="p">,</span> <span class="s1">&#39;/m/0g_fl&#39;</span><span class="p">,</span> <span class="s1">&#39;/m/0108bn2x&#39;</span><span class="p">,</span><span class="s1">&#39;/m/0965sb&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;/g/1214g6vy&#39;</span><span class="p">,</span> <span class="s1">&#39;/m/0drqp&#39;</span><span class="p">,</span> <span class="s1">&#39;/m/09jx2&#39;</span><span class="p">,</span> <span class="s1">&#39;/m/07g82&#39;</span><span class="p">,</span> <span class="s1">&#39;/m/0f10yl&#39;</span><span class="p">,</span><span class="s1">&#39;/g/11j2cc_qll&#39;</span><span class="p">,</span><span class="s1">&#39;/m/061s4&#39;</span><span class="p">]</span>
<span class="n">topicsNames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cryptocurrency_top&#39;</span><span class="p">,</span> <span class="s1">&#39;bitcoin_top&#39;</span><span class="p">,</span> <span class="s1">&#39;investment_top&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;ethereum_top&#39;</span><span class="p">,</span><span class="s1">&#39;exchange_top&#39;</span><span class="p">,</span> <span class="s1">&#39;bankrup_top&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;stock_market_top&#39;</span><span class="p">,</span> <span class="s1">&#39;inflation&#39;</span><span class="p">,</span> <span class="s1">&#39;taxes&#39;</span><span class="p">,</span> <span class="s1">&#39;digital_wallet_top&#39;</span><span class="p">,</span> <span class="s1">&#39;covid19&#39;</span><span class="p">,</span> <span class="s1">&#39;pandemic&#39;</span><span class="p">]</span>
<span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="mi">904</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">814</span><span class="p">]</span>
<span class="n">categoriesNames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;future_commodities&#39;</span><span class="p">,</span> <span class="s1">&#39;banking&#39;</span><span class="p">,</span> <span class="s1">&#39;foreign_currency&#39;</span><span class="p">]</span> 
<span class="n">kw_list</span> <span class="o">=</span> <span class="n">crypto</span> <span class="o">+</span> <span class="n">monetary</span> <span class="o">+</span> <span class="n">policy</span> <span class="o">+</span> <span class="n">topics</span> <span class="o">+</span> <span class="n">influencers</span> <span class="o">+</span> <span class="n">categories</span>
<span class="n">kw_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;cryptocurrency&#39;,
 &#39;crypto&#39;,
 &#39;bitcoin&#39;,
 &#39;bitcoin price&#39;,
 &#39;ethereum&#39;,
 &#39;ethereum price&#39;,
 &#39;stock market&#39;,
 &#39;wall street&#39;,
 &#39;interest rate&#39;,
 &#39;fed&#39;,
 &#39;bankruptcy&#39;,
 &#39;china&#39;,
 &#39;united states&#39;,
 &#39;war&#39;,
 &#39;russia&#39;,
 &#39;/m/0vpj4_b&#39;,
 &#39;/m/05p0rrx&#39;,
 &#39;/m/0g_fl&#39;,
 &#39;/m/0108bn2x&#39;,
 &#39;/m/0965sb&#39;,
 &#39;/g/1214g6vy&#39;,
 &#39;/m/0drqp&#39;,
 &#39;/m/09jx2&#39;,
 &#39;/m/07g82&#39;,
 &#39;/m/0f10yl&#39;,
 &#39;/g/11j2cc_qll&#39;,
 &#39;/m/061s4&#39;,
 &#39;elon musk&#39;,
 &#39;do kwon&#39;,
 904,
 37,
 814]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;2015-08-01&#39;</span> <span class="c1"># parece ser el límite inferior de precios de bitcoin en yahoo finance</span>
<span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;2022-06-15&#39;</span>
<span class="n">var_dict</span> <span class="o">=</span> <span class="n">daily_gt</span><span class="p">(</span><span class="n">keyword</span> <span class="o">=</span> <span class="n">kw_list</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">end</span><span class="p">,</span> <span class="n">inputCategories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">inputCategoriesNames</span><span class="o">=</span><span class="n">categoriesNames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0: cryptocurrency
Iteration from 2015-08-01 to 2015-11-01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/dz/lr2v3wcs73x5vp_ttqq0b7hw0000gn/T/ipykernel_7075/1947064764.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  dataset = dataset.append(data)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration from 2015-11-02 to 2016-02-02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/dz/lr2v3wcs73x5vp_ttqq0b7hw0000gn/T/ipykernel_7075/1947064764.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  dataset = dataset.append(data)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration from 2016-02-03 to 2016-05-05
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/dz/lr2v3wcs73x5vp_ttqq0b7hw0000gn/T/ipykernel_7075/1947064764.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  dataset = dataset.append(data)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration from 2016-05-06 to 2016-08-06
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/dz/lr2v3wcs73x5vp_ttqq0b7hw0000gn/T/ipykernel_7075/1947064764.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  dataset = dataset.append(data)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration from 2016-08-07 to 2016-11-07
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/dz/lr2v3wcs73x5vp_ttqq0b7hw0000gn/T/ipykernel_7075/1947064764.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  dataset = dataset.append(data)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration from 2016-11-08 to 2017-02-08
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/dz/lr2v3wcs73x5vp_ttqq0b7hw0000gn/T/ipykernel_7075/1947064764.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  dataset = dataset.append(data)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration from 2017-02-09 to 2017-05-12
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/dz/lr2v3wcs73x5vp_ttqq0b7hw0000gn/T/ipykernel_7075/1947064764.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  dataset = dataset.append(data)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration from 2017-05-13 to 2017-08-13
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">Input In [5],</span> in <span class="ni">&lt;cell line: 3&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;2015-08-01&#39;</span> <span class="c1"># parece ser el límite inferior de precios de bitcoin en yahoo finance</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;2022-06-15&#39;</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">var_dict</span> <span class="o">=</span> <span class="n">daily_gt</span><span class="p">(</span><span class="n">keyword</span> <span class="o">=</span> <span class="n">kw_list</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">end</span><span class="p">,</span> <span class="n">inputCategories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">inputCategoriesNames</span><span class="o">=</span><span class="n">categoriesNames</span><span class="p">)</span>

<span class="nn">Input In [3],</span> in <span class="ni">daily_gt</span><span class="nt">(keyword, start, end, inputCategories, inputCategoriesNames, hl, tz)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span>   <span class="n">pytrends</span><span class="o">.</span><span class="n">build_payload</span><span class="p">(</span><span class="n">kw_list</span><span class="o">=</span><span class="p">[</span><span class="n">varName</span><span class="p">],</span> <span class="n">cat</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">timeframe</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">startNew</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">timelist</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
<span class="ne">---&gt; </span><span class="mi">57</span>   <span class="n">data</span> <span class="o">=</span> <span class="n">pytrends</span><span class="o">.</span><span class="n">interest_over_time</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span> <span class="c1"># chequear que la base importada no esté vacía antes de trabajarla, sino pasar a la prox palabra</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span>   <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;isPartial&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">))</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/site-packages/pytrends/request.py:226,</span> in <span class="ni">TrendReq.interest_over_time</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span> <span class="n">over_time_payload</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>     <span class="c1"># convert to string as requests will mangle</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="s1">&#39;req&#39;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interest_over_time_widget</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]),</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>     <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">interest_over_time_widget</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="s1">&#39;tz&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span> <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span> <span class="c1"># make the request and parse the returned json</span>
<span class="ne">--&gt; </span><span class="mi">226</span> <span class="n">req_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span>     <span class="n">url</span><span class="o">=</span><span class="n">TrendReq</span><span class="o">.</span><span class="n">INTEREST_OVER_TIME_URL</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span>     <span class="n">method</span><span class="o">=</span><span class="n">TrendReq</span><span class="o">.</span><span class="n">GET_METHOD</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">229</span>     <span class="n">trim_chars</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span>     <span class="n">params</span><span class="o">=</span><span class="n">over_time_payload</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">req_json</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">][</span><span class="s1">&#39;timelineData&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">234</span> <span class="k">if</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">):</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/site-packages/pytrends/request.py:138,</span> in <span class="ni">TrendReq._get_data</span><span class="nt">(self, url, method, trim_chars, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="n">response</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span>                       <span class="n">cookies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cookies</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span>                       <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">requests_args</span><span class="p">)</span>  <span class="c1"># DO NOT USE retries or backoff_factor here</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">138</span>     <span class="n">response</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cookies</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span>                      <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">requests_args</span><span class="p">)</span>  <span class="c1"># DO NOT USE retries or backoff_factor here</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span> <span class="c1"># check if the response contains json and throw an exception otherwise</span>
<span class="g g-Whitespace">    </span><span class="mi">141</span> <span class="c1"># Google mostly sends &#39;application/json&#39; in the Content-Type header,</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span> <span class="c1"># but occasionally it sends &#39;application/javascript</span>
<span class="g g-Whitespace">    </span><span class="mi">143</span> <span class="c1"># and sometimes even &#39;text/javascript</span>
<span class="g g-Whitespace">    </span><span class="mi">144</span> <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">and</span> <span class="s1">&#39;application/json&#39;</span> <span class="ow">in</span> \
<span class="g g-Whitespace">    </span><span class="mi">145</span>         <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">]</span> <span class="ow">or</span> \
<span class="g g-Whitespace">    </span><span class="mi">146</span>         <span class="s1">&#39;application/javascript&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">]</span> <span class="ow">or</span> \
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>     <span class="c1"># some responses start with garbage characters, like &quot;)]}&#39;,&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>     <span class="c1"># these have to be cleaned before being passed to the json parser</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/site-packages/requests/sessions.py:542,</span> in <span class="ni">Session.get</span><span class="nt">(self, url, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">534</span> <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sends a GET request. Returns :class:`Response` object.</span>
<span class="g g-Whitespace">    </span><span class="mi">535</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">536</span><span class="sd"> :param url: URL for the new :class:`Request` object.</span>
<span class="g g-Whitespace">    </span><span class="mi">537</span><span class="sd"> :param \*\*kwargs: Optional arguments that ``request`` takes.</span>
<span class="g g-Whitespace">    </span><span class="mi">538</span><span class="sd"> :rtype: requests.Response</span>
<span class="g g-Whitespace">    </span><span class="mi">539</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">541</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;allow_redirects&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">542</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/site-packages/requests/sessions.py:529,</span> in <span class="ni">Session.request</span><span class="nt">(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)</span>
<span class="g g-Whitespace">    </span><span class="mi">524</span> <span class="n">send_kwargs</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">525</span>     <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">526</span>     <span class="s1">&#39;allow_redirects&#39;</span><span class="p">:</span> <span class="n">allow_redirects</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">527</span> <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">528</span> <span class="n">send_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">529</span> <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">prep</span><span class="p">,</span> <span class="o">**</span><span class="n">send_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">531</span> <span class="k">return</span> <span class="n">resp</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/site-packages/requests/sessions.py:645,</span> in <span class="ni">Session.send</span><span class="nt">(self, request, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">642</span> <span class="n">start</span> <span class="o">=</span> <span class="n">preferred_clock</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">644</span> <span class="c1"># Send the request</span>
<span class="ne">--&gt; </span><span class="mi">645</span> <span class="n">r</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">647</span> <span class="c1"># Total elapsed time of the request (approximately)</span>
<span class="g g-Whitespace">    </span><span class="mi">648</span> <span class="n">elapsed</span> <span class="o">=</span> <span class="n">preferred_clock</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/site-packages/requests/adapters.py:440,</span> in <span class="ni">HTTPAdapter.send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">438</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">chunked</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">440</span>         <span class="n">resp</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span>             <span class="n">method</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span>             <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span>             <span class="n">body</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span>             <span class="n">headers</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">445</span>             <span class="n">redirect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">446</span>             <span class="n">assert_same_host</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">447</span>             <span class="n">preload_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">448</span>             <span class="n">decode_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">449</span>             <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span>             <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">453</span>     <span class="c1"># Send the request.</span>
<span class="g g-Whitespace">    </span><span class="mi">454</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span>         <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="s1">&#39;proxy_pool&#39;</span><span class="p">):</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/site-packages/urllib3/connectionpool.py:699,</span> in <span class="ni">HTTPConnectionPool.urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">696</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_proxy</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">698</span> <span class="c1"># Make the request on the httplib connection object.</span>
<span class="ne">--&gt; </span><span class="mi">699</span> <span class="n">httplib_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span>     <span class="n">conn</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">701</span>     <span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span>     <span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout_obj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">704</span>     <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span>     <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span>     <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">707</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">709</span> <span class="c1"># If we&#39;re going to release the connection in ``finally:``, then</span>
<span class="g g-Whitespace">    </span><span class="mi">710</span> <span class="c1"># the response doesn&#39;t need to know about the connection. Otherwise</span>
<span class="g g-Whitespace">    </span><span class="mi">711</span> <span class="c1"># it will also try to release it and we&#39;ll have a double-release</span>
<span class="g g-Whitespace">    </span><span class="mi">712</span> <span class="c1"># mess.</span>
<span class="g g-Whitespace">    </span><span class="mi">713</span> <span class="n">response_conn</span> <span class="o">=</span> <span class="n">conn</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">release_conn</span> <span class="k">else</span> <span class="kc">None</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/site-packages/urllib3/connectionpool.py:445,</span> in <span class="ni">HTTPConnectionPool._make_request</span><span class="nt">(self, conn, method, url, timeout, chunked, **httplib_request_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">440</span>             <span class="n">httplib_response</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span>         <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span>             <span class="c1"># Remove the TypeError from the exception chain in</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span>             <span class="c1"># Python 3 (including for exceptions like SystemExit).</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span>             <span class="c1"># Otherwise it looks like a bug in the code.</span>
<span class="ne">--&gt; </span><span class="mi">445</span>             <span class="n">six</span><span class="o">.</span><span class="n">raise_from</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">446</span> <span class="k">except</span> <span class="p">(</span><span class="n">SocketTimeout</span><span class="p">,</span> <span class="n">BaseSSLError</span><span class="p">,</span> <span class="n">SocketError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">447</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_raise_timeout</span><span class="p">(</span><span class="n">err</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout_value</span><span class="o">=</span><span class="n">read_timeout</span><span class="p">)</span>

<span class="nn">File &lt;string&gt;:3,</span> in <span class="ni">raise_from</span><span class="nt">(value, from_value)</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/site-packages/urllib3/connectionpool.py:440,</span> in <span class="ni">HTTPConnectionPool._make_request</span><span class="nt">(self, conn, method, url, timeout, chunked, **httplib_request_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">437</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">438</span>     <span class="c1"># Python 3</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">440</span>         <span class="n">httplib_response</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span>     <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span>         <span class="c1"># Remove the TypeError from the exception chain in</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span>         <span class="c1"># Python 3 (including for exceptions like SystemExit).</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span>         <span class="c1"># Otherwise it looks like a bug in the code.</span>
<span class="g g-Whitespace">    </span><span class="mi">445</span>         <span class="n">six</span><span class="o">.</span><span class="n">raise_from</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/http/client.py:1371,</span> in <span class="ni">HTTPConnection.getresponse</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1369</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1370</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1371</span>         <span class="n">response</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1372</span>     <span class="k">except</span> <span class="ne">ConnectionError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1373</span>         <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/http/client.py:319,</span> in <span class="ni">HTTPResponse.begin</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span> <span class="c1"># read until we get a non-100 response</span>
<span class="g g-Whitespace">    </span><span class="mi">318</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">319</span>     <span class="n">version</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">reason</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_status</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span>     <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="n">CONTINUE</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span>         <span class="k">break</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/http/client.py:280,</span> in <span class="ni">HTTPResponse._read_status</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span> <span class="k">def</span> <span class="nf">_read_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">280</span>     <span class="n">line</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="n">_MAXLINE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;iso-8859-1&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">281</span>     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">_MAXLINE</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">282</span>         <span class="k">raise</span> <span class="n">LineTooLong</span><span class="p">(</span><span class="s2">&quot;status line&quot;</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/socket.py:704,</span> in <span class="ni">SocketIO.readinto</span><span class="nt">(self, b)</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">704</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sock</span><span class="o">.</span><span class="n">recv_into</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span>     <span class="k">except</span> <span class="n">timeout</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_timeout_occurred</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/ssl.py:1241,</span> in <span class="ni">SSLSocket.recv_into</span><span class="nt">(self, buffer, nbytes, flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1237</span>     <span class="k">if</span> <span class="n">flags</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1238</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1239</span>           <span class="s2">&quot;non-zero flags not allowed in calls to recv_into() on </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
<span class="g g-Whitespace">   </span><span class="mi">1240</span>           <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1241</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nbytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1242</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1243</span>     <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">recv_into</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/lib/python3.9/ssl.py:1099,</span> in <span class="ni">SSLSocket.read</span><span class="nt">(self, len, buffer)</span>
<span class="g g-Whitespace">   </span><span class="mi">1097</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1098</span>     <span class="k">if</span> <span class="n">buffer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1099</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1100</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1101</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_values([     cryptocurrency    year  month   day  cryptocurrency_historical  \
0                46  2015.0    8.0   1.0                          0   
1                69  2015.0    8.0   2.0                          0   
2                52  2015.0    8.0   3.0                          0   
3                81  2015.0    8.0   4.0                          0   
4                68  2015.0    8.0   5.0                          0   
...             ...     ...    ...   ...                        ...   
2505             25  2022.0    6.0  10.0                         20   
2506             25  2022.0    6.0  11.0                         20   
2507             36  2022.0    6.0  12.0                         20   
2508             73  2022.0    6.0  13.0                         20   
2509              0  2022.0    6.0  14.0                         20   

     cryptocurrency_adjusted  
0                        0.0  
1                        0.0  
2                        0.0  
3                        0.0  
4                        0.0  
...                      ...  
2505                     5.0  
2506                     5.0  
2507                     7.2  
2508                    14.6  
2509                     0.0  

[2510 rows x 6 columns],      crypto    year  month   day  crypto_historical crypto_adjusted
0        63  2015.0    8.0   1.0                  1            0.63
1        64  2015.0    8.0   2.0                  1            0.64
2        72  2015.0    8.0   3.0                  1            0.72
3        90  2015.0    8.0   4.0                  1             0.9
4        79  2015.0    8.0   5.0                  1            0.79
...     ...     ...    ...   ...                ...             ...
2505     19  2022.0    6.0  10.0                 34            6.46
2506     21  2022.0    6.0  11.0                 34            7.14
2507     24  2022.0    6.0  12.0                 34            8.16
2508     47  2022.0    6.0  13.0                 34           15.98
2509      0  2022.0    6.0  14.0                 34             0.0

[2510 rows x 6 columns],      bitcoin    year  month   day  bitcoin_historical bitcoin_adjusted
0        100  2015.0    8.0   1.0                   3              3.0
1         77  2015.0    8.0   2.0                   3             2.31
2         73  2015.0    8.0   3.0                   3             2.19
3         72  2015.0    8.0   4.0                   3             2.16
4         64  2015.0    8.0   5.0                   3             1.92
...      ...     ...    ...   ...                 ...              ...
2505      29  2022.0    6.0  10.0                  29             8.41
2506      31  2022.0    6.0  11.0                  29             8.99
2507      38  2022.0    6.0  12.0                  29            11.02
2508      97  2022.0    6.0  13.0                  29            28.13
2509       0  2022.0    6.0  14.0                  29              0.0

[2510 rows x 6 columns],      bitcoin price    year  month   day  bitcoin price_historical  \
0               71  2015.0    8.0   1.0                         1   
1               53  2015.0    8.0   2.0                         1   
2               44  2015.0    8.0   3.0                         1   
3               46  2015.0    8.0   4.0                         1   
4               37  2015.0    8.0   5.0                         1   
...            ...     ...    ...   ...                       ...   
2505            24  2022.0    6.0  10.0                        35   
2506            28  2022.0    6.0  11.0                        35   
2507            32  2022.0    6.0  12.0                        35   
2508           100  2022.0    6.0  13.0                        35   
2509             0  2022.0    6.0  14.0                        35   

     bitcoin price_adjusted  
0                      0.71  
1                      0.53  
2                      0.44  
3                      0.46  
4                      0.37  
...                     ...  
2505                    8.4  
2506                    9.8  
2507                   11.2  
2508                   35.0  
2509                    0.0  

[2510 rows x 6 columns],      ethereum    year  month   day  ethereum_historical ethereum_adjusted
0          85  2015.0    8.0   1.0                    0               0.0
1          69  2015.0    8.0   2.0                    0               0.0
2          67  2015.0    8.0   3.0                    0               0.0
3          47  2015.0    8.0   4.0                    0               0.0
4          58  2015.0    8.0   5.0                    0               0.0
...       ...     ...    ...   ...                  ...               ...
2505       35  2022.0    6.0  10.0                   26               9.1
2506       59  2022.0    6.0  11.0                   26             15.34
2507       59  2022.0    6.0  12.0                   26             15.34
2508      100  2022.0    6.0  13.0                   26              26.0
2509        0  2022.0    6.0  14.0                   26               0.0

[2510 rows x 6 columns],      ethereum price    year  month   day  ethereum price_historical  \
0                20  2015.0    8.0   1.0                          0   
1                61  2015.0    8.0   2.0                          0   
2                17  2015.0    8.0   3.0                          0   
3                33  2015.0    8.0   4.0                          0   
4                 0  2015.0    8.0   5.0                          0   
...             ...     ...    ...   ...                        ...   
2505             28  2022.0    6.0  10.0                         27   
2506             62  2022.0    6.0  11.0                         27   
2507             57  2022.0    6.0  12.0                         27   
2508            100  2022.0    6.0  13.0                         27   
2509              0  2022.0    6.0  14.0                         27   

     ethereum price_adjusted  
0                        0.0  
1                        0.0  
2                        0.0  
3                        0.0  
4                        0.0  
...                      ...  
2505                    7.56  
2506                   16.74  
2507                   15.39  
2508                    27.0  
2509                     0.0  

[2510 rows x 6 columns],      stock market    year  month   day  stock market_historical  \
0               5  2015.0    8.0   1.0                       29   
1               5  2015.0    8.0   2.0                       29   
2              10  2015.0    8.0   3.0                       29   
3               9  2015.0    8.0   4.0                       29   
4               9  2015.0    8.0   5.0                       29   
...           ...     ...    ...   ...                      ...   
2505           60  2022.0    6.0  10.0                       30   
2506           29  2022.0    6.0  11.0                       30   
2507           24  2022.0    6.0  12.0                       30   
2508          100  2022.0    6.0  13.0                       30   
2509            0  2022.0    6.0  14.0                       30   

     stock market_adjusted  
0                     1.45  
1                     1.45  
2                      2.9  
3                     2.61  
4                     2.61  
...                    ...  
2505                  18.0  
2506                   8.7  
2507                   7.2  
2508                  30.0  
2509                   0.0  

[2510 rows x 6 columns],      wall street    year  month   day  wall street_historical  \
0             54  2015.0    8.0   1.0                      16   
1             61  2015.0    8.0   2.0                      16   
2             64  2015.0    8.0   3.0                      16   
3             58  2015.0    8.0   4.0                      16   
4             60  2015.0    8.0   5.0                      16   
...          ...     ...    ...   ...                     ...   
2505          72  2022.0    6.0  10.0                       9   
2506          66  2022.0    6.0  11.0                       9   
2507          67  2022.0    6.0  12.0                       9   
2508          82  2022.0    6.0  13.0                       9   
2509           0  2022.0    6.0  14.0                       9   

     wall street_adjusted  
0                    8.64  
1                    9.76  
2                   10.24  
3                    9.28  
4                     9.6  
...                   ...  
2505                 6.48  
2506                 5.94  
2507                 6.03  
2508                 7.38  
2509                  0.0  

[2510 rows x 6 columns],      interest rate    year  month   day  interest rate_historical  \
0               39  2015.0    8.0   1.0                        42   
1               33  2015.0    8.0   2.0                        42   
2               55  2015.0    8.0   3.0                        42   
3               48  2015.0    8.0   4.0                        42   
4               52  2015.0    8.0   5.0                        42   
...            ...     ...    ...   ...                       ...   
2505            61  2022.0    6.0  10.0                       100   
2506            53  2022.0    6.0  11.0                       100   
2507            46  2022.0    6.0  12.0                       100   
2508            66  2022.0    6.0  13.0                       100   
2509             0  2022.0    6.0  14.0                       100   

     interest rate_adjusted  
0                     16.38  
1                     13.86  
2                      23.1  
3                     20.16  
4                     21.84  
...                     ...  
2505                   61.0  
2506                   53.0  
2507                   46.0  
2508                   66.0  
2509                    0.0  

[2510 rows x 6 columns],      fed    year  month   day  fed_historical fed_adjusted
0     13  2015.0    8.0   1.0              49         6.37
1     12  2015.0    8.0   2.0              49         5.88
2     17  2015.0    8.0   3.0              49         8.33
3     19  2015.0    8.0   4.0              49         9.31
4     19  2015.0    8.0   5.0              49         9.31
...   ..     ...    ...   ...             ...          ...
2505  19  2022.0    6.0  10.0              53        10.07
2506  13  2022.0    6.0  11.0              53         6.89
2507  14  2022.0    6.0  12.0              53         7.42
2508  31  2022.0    6.0  13.0              53        16.43
2509   0  2022.0    6.0  14.0              53          0.0

[2510 rows x 6 columns],      bankruptcy    year  month   day  bankruptcy_historical  \
0            41  2015.0    8.0   1.0                     33   
1            41  2015.0    8.0   2.0                     33   
2            70  2015.0    8.0   3.0                     33   
3            76  2015.0    8.0   4.0                     33   
4            75  2015.0    8.0   5.0                     33   
...         ...     ...    ...   ...                    ...   
2505         59  2022.0    6.0  10.0                     20   
2506         44  2022.0    6.0  11.0                     20   
2507         43  2022.0    6.0  12.0                     20   
2508         68  2022.0    6.0  13.0                     20   
2509          0  2022.0    6.0  14.0                     20   

     bankruptcy_adjusted  
0                  13.53  
1                  13.53  
2                   23.1  
3                  25.08  
4                  24.75  
...                  ...  
2505                11.8  
2506                 8.8  
2507                 8.6  
2508                13.6  
2509                 0.0  

[2510 rows x 6 columns],      china    year  month   day  china_historical china_adjusted
0       41  2015.0    8.0   1.0                48          19.68
1       41  2015.0    8.0   2.0                48          19.68
2       42  2015.0    8.0   3.0                48          20.16
3       41  2015.0    8.0   4.0                48          19.68
4       42  2015.0    8.0   5.0                48          20.16
...    ...     ...    ...   ...               ...            ...
2505    47  2022.0    6.0  10.0                35          16.45
2506    49  2022.0    6.0  11.0                35          17.15
2507    51  2022.0    6.0  12.0                35          17.85
2508    48  2022.0    6.0  13.0                35           16.8
2509     0  2022.0    6.0  14.0                35            0.0

[2510 rows x 6 columns],      united states    year  month   day  united states_historical  \
0               73  2015.0    8.0   1.0                        27   
1               77  2015.0    8.0   2.0                        27   
2               86  2015.0    8.0   3.0                        27   
3               85  2015.0    8.0   4.0                        27   
4               85  2015.0    8.0   5.0                        27   
...            ...     ...    ...   ...                       ...   
2505            38  2022.0    6.0  10.0                        35   
2506            38  2022.0    6.0  11.0                        35   
2507            38  2022.0    6.0  12.0                        35   
2508            36  2022.0    6.0  13.0                        35   
2509             0  2022.0    6.0  14.0                        35   

     united states_adjusted  
0                     19.71  
1                     20.79  
2                     23.22  
3                     22.95  
4                     22.95  
...                     ...  
2505                   13.3  
2506                   13.3  
2507                   13.3  
2508                   12.6  
2509                    0.0  

[2510 rows x 6 columns],      war    year  month   day  war_historical war_adjusted
0     68  2015.0    8.0   1.0              43        29.24
1     74  2015.0    8.0   2.0              43        31.82
2     60  2015.0    8.0   3.0              43         25.8
3     62  2015.0    8.0   4.0              43        26.66
4     61  2015.0    8.0   5.0              43        26.23
...   ..     ...    ...   ...             ...          ...
2505  61  2022.0    6.0  10.0              34        20.74
2506  68  2022.0    6.0  11.0              34        23.12
2507  74  2022.0    6.0  12.0              34        25.16
2508  62  2022.0    6.0  13.0              34        21.08
2509   0  2022.0    6.0  14.0              34          0.0

[2510 rows x 6 columns],      russia    year  month   day  russia_historical russia_adjusted
0        37  2015.0    8.0   1.0                  6            2.22
1        45  2015.0    8.0   2.0                  6             2.7
2        41  2015.0    8.0   3.0                  6            2.46
3        40  2015.0    8.0   4.0                  6             2.4
4        41  2015.0    8.0   5.0                  6            2.46
...     ...     ...    ...   ...                ...             ...
2505     22  2022.0    6.0  10.0                 16            3.52
2506     19  2022.0    6.0  11.0                 16            3.04
2507     23  2022.0    6.0  12.0                 16            3.68
2508     21  2022.0    6.0  13.0                 16            3.36
2509      0  2022.0    6.0  14.0                 16             0.0

[2510 rows x 6 columns],      /m/0vpj4_b    year  month   day  /m/0vpj4_b_historical  \
0            75  2015.0    8.0   1.0                      1   
1            85  2015.0    8.0   2.0                      1   
2            78  2015.0    8.0   3.0                      1   
3            91  2015.0    8.0   4.0                      1   
4            79  2015.0    8.0   5.0                      1   
...         ...     ...    ...   ...                    ...   
2505         19  2022.0    6.0  10.0                     31   
2506         20  2022.0    6.0  11.0                     31   
2507         26  2022.0    6.0  12.0                     31   
2508         52  2022.0    6.0  13.0                     31   
2509          0  2022.0    6.0  14.0                     31   

     /m/0vpj4_b_adjusted  
0                   0.75  
1                   0.85  
2                   0.78  
3                   0.91  
4                   0.79  
...                  ...  
2505                5.89  
2506                 6.2  
2507                8.06  
2508               16.12  
2509                 0.0  

[2510 rows x 6 columns],      /m/05p0rrx    year  month   day  /m/05p0rrx_historical  \
0           100  2015.0    8.0   1.0                      3   
1            81  2015.0    8.0   2.0                      3   
2            77  2015.0    8.0   3.0                      3   
3            73  2015.0    8.0   4.0                      3   
4            70  2015.0    8.0   5.0                      3   
...         ...     ...    ...   ...                    ...   
2505         30  2022.0    6.0  10.0                     32   
2506         32  2022.0    6.0  11.0                     32   
2507         40  2022.0    6.0  12.0                     32   
2508         98  2022.0    6.0  13.0                     32   
2509          0  2022.0    6.0  14.0                     32   

     /m/05p0rrx_adjusted  
0                    3.0  
1                   2.43  
2                   2.31  
3                   2.19  
4                    2.1  
...                  ...  
2505                 9.6  
2506               10.24  
2507                12.8  
2508               31.36  
2509                 0.0  

[2510 rows x 6 columns],      /m/0g_fl    year  month   day  /m/0g_fl_historical /m/0g_fl_adjusted
0          48  2015.0    8.0   1.0                   46             22.08
1          50  2015.0    8.0   2.0                   46              23.0
2          88  2015.0    8.0   3.0                   46             40.48
3          91  2015.0    8.0   4.0                   46             41.86
4          85  2015.0    8.0   5.0                   46              39.1
...       ...     ...    ...   ...                  ...               ...
2505       82  2022.0    6.0  10.0                   66             54.12
2506       58  2022.0    6.0  11.0                   66             38.28
2507       61  2022.0    6.0  12.0                   66             40.26
2508       90  2022.0    6.0  13.0                   66              59.4
2509        0  2022.0    6.0  14.0                   66               0.0

[2510 rows x 6 columns],      /m/0108bn2x    year  month   day  /m/0108bn2x_historical  \
0             77  2015.0    8.0   1.0                       1   
1             63  2015.0    8.0   2.0                       1   
2             86  2015.0    8.0   3.0                       1   
3             79  2015.0    8.0   4.0                       1   
4             74  2015.0    8.0   5.0                       1   
...          ...     ...    ...   ...                     ...   
2505          32  2022.0    6.0  10.0                      30   
2506          48  2022.0    6.0  11.0                      30   
2507          50  2022.0    6.0  12.0                      30   
2508         100  2022.0    6.0  13.0                      30   
2509           0  2022.0    6.0  14.0                      30   

     /m/0108bn2x_adjusted  
0                    0.77  
1                    0.63  
2                    0.86  
3                    0.79  
4                    0.74  
...                   ...  
2505                  9.6  
2506                 14.4  
2507                 15.0  
2508                 30.0  
2509                  0.0  

[2510 rows x 6 columns],      /m/0965sb    year  month   day  /m/0965sb_historical /m/0965sb_adjusted
0           84  2015.0    8.0   1.0                     2               1.68
1           76  2015.0    8.0   2.0                     2               1.52
2           52  2015.0    8.0   3.0                     2               1.04
3           78  2015.0    8.0   4.0                     2               1.56
4           68  2015.0    8.0   5.0                     2               1.36
...        ...     ...    ...   ...                   ...                ...
2505        66  2022.0    6.0  10.0                    19              12.54
2506        57  2022.0    6.0  11.0                    19              10.83
2507        58  2022.0    6.0  12.0                    19              11.02
2508        74  2022.0    6.0  13.0                    19              14.06
2509         0  2022.0    6.0  14.0                    19                0.0

[2510 rows x 6 columns],      /g/1214g6vy    year  month   day  /g/1214g6vy_historical  \
0             31  2015.0    8.0   1.0                      28   
1             32  2015.0    8.0   2.0                      28   
2             62  2015.0    8.0   3.0                      28   
3             63  2015.0    8.0   4.0                      28   
4             64  2015.0    8.0   5.0                      28   
...          ...     ...    ...   ...                     ...   
2505          79  2022.0    6.0  10.0                      38   
2506          28  2022.0    6.0  11.0                      38   
2507          42  2022.0    6.0  12.0                      38   
2508          68  2022.0    6.0  13.0                      38   
2509           0  2022.0    6.0  14.0                      38   

     /g/1214g6vy_adjusted  
0                    8.68  
1                    8.96  
2                   17.36  
3                   17.64  
4                   17.92  
...                   ...  
2505                30.02  
2506                10.64  
2507                15.96  
2508                25.84  
2509                  0.0  

[2510 rows x 6 columns],      /m/0drqp    year  month   day  /m/0drqp_historical /m/0drqp_adjusted
0           6  2015.0    8.0   1.0                   33              1.98
1           6  2015.0    8.0   2.0                   33              1.98
2          14  2015.0    8.0   3.0                   33              4.62
3          12  2015.0    8.0   4.0                   33              3.96
4          12  2015.0    8.0   5.0                   33              3.96
...       ...     ...    ...   ...                  ...               ...
2505       57  2022.0    6.0  10.0                   38             21.66
2506       26  2022.0    6.0  11.0                   38              9.88
2507       20  2022.0    6.0  12.0                   38               7.6
2508      100  2022.0    6.0  13.0                   38              38.0
2509        0  2022.0    6.0  14.0                   38               0.0

[2510 rows x 6 columns],      /m/09jx2    year  month   day  /m/09jx2_historical /m/09jx2_adjusted
0          46  2015.0    8.0   1.0                   24             11.04
1          54  2015.0    8.0   2.0                   24             12.96
2          76  2015.0    8.0   3.0                   24             18.24
3          73  2015.0    8.0   4.0                   24             17.52
4          68  2015.0    8.0   5.0                   24             16.32
...       ...     ...    ...   ...                  ...               ...
2505      100  2022.0    6.0  10.0                  100             100.0
2506       53  2022.0    6.0  11.0                  100              53.0
2507       46  2022.0    6.0  12.0                  100              46.0
2508       62  2022.0    6.0  13.0                  100              62.0
2509        0  2022.0    6.0  14.0                  100               0.0

[2510 rows x 6 columns],      /m/07g82    year  month   day  /m/07g82_historical /m/07g82_adjusted
0          56  2015.0    8.0   1.0                   53             29.68
1          49  2015.0    8.0   2.0                   53             25.97
2          79  2015.0    8.0   3.0                   53             41.87
3          83  2015.0    8.0   4.0                   53             43.99
4          81  2015.0    8.0   5.0                   53             42.93
...       ...     ...    ...   ...                  ...               ...
2505       49  2022.0    6.0  10.0                   66             32.34
2506       35  2022.0    6.0  11.0                   66              23.1
2507       33  2022.0    6.0  12.0                   66             21.78
2508       53  2022.0    6.0  13.0                   66             34.98
2509        0  2022.0    6.0  14.0                   66               0.0

[2510 rows x 6 columns],      /m/0f10yl    year  month   day  /m/0f10yl_historical /m/0f10yl_adjusted
0           90  2015.0    8.0   1.0                    17               15.3
1           58  2015.0    8.0   2.0                    17               9.86
2           67  2015.0    8.0   3.0                    17              11.39
3           77  2015.0    8.0   4.0                    17              13.09
4           66  2015.0    8.0   5.0                    17              11.22
...        ...     ...    ...   ...                   ...                ...
2505        49  2022.0    6.0  10.0                    70               34.3
2506        49  2022.0    6.0  11.0                    70               34.3
2507        44  2022.0    6.0  12.0                    70               30.8
2508        51  2022.0    6.0  13.0                    70               35.7
2509         0  2022.0    6.0  14.0                    70                0.0

[2510 rows x 6 columns],      /g/11j2cc_qll    year  month   day  /g/11j2cc_qll_historical  \
0               24  2015.0    8.0   1.0                         0   
1               29  2015.0    8.0   2.0                         0   
2               33  2015.0    8.0   3.0                         0   
3               25  2015.0    8.0   4.0                         0   
4               41  2015.0    8.0   5.0                         0   
...            ...     ...    ...   ...                       ...   
2505            64  2022.0    6.0  10.0                         7   
2506            58  2022.0    6.0  11.0                         7   
2507            56  2022.0    6.0  12.0                         7   
2508            62  2022.0    6.0  13.0                         7   
2509             0  2022.0    6.0  14.0                         7   

     /g/11j2cc_qll_adjusted  
0                       0.0  
1                       0.0  
2                       0.0  
3                       0.0  
4                       0.0  
...                     ...  
2505                   4.48  
2506                   4.06  
2507                   3.92  
2508                   4.34  
2509                    0.0  

[2510 rows x 6 columns],      /m/061s4    year  month   day  /m/061s4_historical /m/061s4_adjusted
0          45  2015.0    8.0   1.0                    1              0.45
1          70  2015.0    8.0   2.0                    1               0.7
2          44  2015.0    8.0   3.0                    1              0.44
3          60  2015.0    8.0   4.0                    1               0.6
4          56  2015.0    8.0   5.0                    1              0.56
...       ...     ...    ...   ...                  ...               ...
2505       56  2022.0    6.0  10.0                    7              3.92
2506       47  2022.0    6.0  11.0                    7              3.29
2507       53  2022.0    6.0  12.0                    7              3.71
2508       63  2022.0    6.0  13.0                    7              4.41
2509        0  2022.0    6.0  14.0                    7               0.0

[2510 rows x 6 columns],      elon musk    year  month   day  elon musk_historical elon musk_adjusted
0           20  2015.0    8.0   1.0                     3                0.6
1           22  2015.0    8.0   2.0                     3               0.66
2           20  2015.0    8.0   3.0                     3                0.6
3           21  2015.0    8.0   4.0                     3               0.63
4           26  2015.0    8.0   5.0                     3               0.78
...        ...     ...    ...   ...                   ...                ...
2505         5  2022.0    6.0  10.0                    40                2.0
2506         5  2022.0    6.0  11.0                    40                2.0
2507         6  2022.0    6.0  12.0                    40                2.4
2508         5  2022.0    6.0  13.0                    40                2.0
2509         0  2022.0    6.0  14.0                    40                0.0

[2510 rows x 6 columns],      do kwon    year  month   day  do kwon_historical do kwon_adjusted
0         70  2015.0    8.0   1.0                  10              7.0
1         63  2015.0    8.0   2.0                  10              6.3
2         59  2015.0    8.0   3.0                  10              5.9
3         85  2015.0    8.0   4.0                  10              8.5
4         86  2015.0    8.0   5.0                  10              8.6
...      ...     ...    ...   ...                 ...              ...
2505       9  2022.0    6.0  10.0                  10              0.9
2506       9  2022.0    6.0  11.0                  10              0.9
2507       9  2022.0    6.0  12.0                  10              0.9
2508       6  2022.0    6.0  13.0                  10              0.6
2509       0  2022.0    6.0  14.0                  10              0.0

[2510 rows x 6 columns],        day  future_commodities  month    year  future_commodities_historical  \
0      1.0                60.0    8.0  2015.0                             45   
1      2.0                51.0    8.0  2015.0                             45   
2      3.0                72.0    8.0  2015.0                             45   
3      4.0                71.0    8.0  2015.0                             45   
4      5.0                71.0    8.0  2015.0                             45   
...    ...                 ...    ...     ...                            ...   
2505  10.0                65.0    6.0  2022.0                             77   
2506  11.0                50.0    6.0  2022.0                             77   
2507  12.0                46.0    6.0  2022.0                             77   
2508  13.0                72.0    6.0  2022.0                             77   
2509  14.0                 0.0    6.0  2022.0                             77   

      future_commodities_adjusted  
0                           27.00  
1                           22.95  
2                           32.40  
3                           31.95  
4                           31.95  
...                           ...  
2505                        50.05  
2506                        38.50  
2507                        35.42  
2508                        55.44  
2509                         0.00  

[2510 rows x 6 columns],       banking   day  month    year  banking_historical  banking_adjusted
0        69.0   1.0    8.0  2015.0                  92             63.48
1        54.0   2.0    8.0  2015.0                  92             49.68
2       100.0   3.0    8.0  2015.0                  92             92.00
3        95.0   4.0    8.0  2015.0                  92             87.40
4        93.0   5.0    8.0  2015.0                  92             85.56
...       ...   ...    ...     ...                 ...               ...
2505     94.0  10.0    6.0  2022.0                  76             71.44
2506     66.0  11.0    6.0  2022.0                  76             50.16
2507     55.0  12.0    6.0  2022.0                  76             41.80
2508     90.0  13.0    6.0  2022.0                  76             68.40
2509      0.0  14.0    6.0  2022.0                  76              0.00

[2510 rows x 6 columns],        day  foreign_currency  month    year  foreign_currency_historical  \
0      1.0              50.0    8.0  2015.0                           52   
1      2.0              47.0    8.0  2015.0                           52   
2      3.0              67.0    8.0  2015.0                           52   
3      4.0              67.0    8.0  2015.0                           52   
4      5.0              66.0    8.0  2015.0                           52   
...    ...               ...    ...     ...                          ...   
2505  10.0              95.0    6.0  2022.0                           90   
2506  11.0              73.0    6.0  2022.0                           90   
2507  12.0              66.0    6.0  2022.0                           90   
2508  13.0              94.0    6.0  2022.0                           90   
2509  14.0               0.0    6.0  2022.0                           90   

      foreign_currency_adjusted  
0                         26.00  
1                         24.44  
2                         34.84  
3                         34.84  
4                         34.32  
...                         ...  
2505                      85.50  
2506                      65.70  
2507                      59.40  
2508                      84.60  
2509                       0.00  

[2510 rows x 6 columns]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span><span class="p">,</span> <span class="n">reduce</span> <span class="c1"># to transform variable dic in a dataframe  </span>
<span class="c1"># merge todos los dataframes en el diccionario var_dict</span>
<span class="n">my_reduce</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="s1">&#39;day&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span> 
<span class="n">gtrends</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">my_reduce</span><span class="p">,</span> <span class="n">var_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="c1"># modificamos las columnas con los tópicos según sus respectivos nombres </span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">topics</span><span class="p">)):</span> 
  <span class="n">dtcol</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">gtrends</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">topics</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="n">dtcol</span><span class="p">:</span>
    <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">topics</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">ex</span><span class="p">[</span><span class="n">num</span><span class="p">:</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">gtrends</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">ex</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">topicsNames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">_&#39;</span> <span class="o">+</span> <span class="n">word</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># generamos la variable fecha para tener como índice</span>
<span class="n">gtrends</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">gtrends</span><span class="p">[[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">]])</span>
<span class="n">gtrends</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">del</span> <span class="n">var_dict</span>
<span class="n">gtrends</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f4f70313-7245-4762-a049-ed525fb33743">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cryptocurrency</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>cryptocurrency_historical</th>
      <th>cryptocurrency_adjusted</th>
      <th>crypto</th>
      <th>crypto_historical</th>
      <th>crypto_adjusted</th>
      <th>bitcoin</th>
      <th>...</th>
      <th>do kwon_adjusted</th>
      <th>future_commodities</th>
      <th>future_commodities_historical</th>
      <th>future_commodities_adjusted</th>
      <th>banking</th>
      <th>banking_historical</th>
      <th>banking_adjusted</th>
      <th>foreign_currency</th>
      <th>foreign_currency_historical</th>
      <th>foreign_currency_adjusted</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-08-01</th>
      <td>46</td>
      <td>2015.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>63</td>
      <td>1</td>
      <td>0.63</td>
      <td>100</td>
      <td>...</td>
      <td>7.0</td>
      <td>60.0</td>
      <td>45</td>
      <td>27.00</td>
      <td>69.0</td>
      <td>92</td>
      <td>63.48</td>
      <td>50.0</td>
      <td>52</td>
      <td>26.00</td>
    </tr>
    <tr>
      <th>2015-08-02</th>
      <td>69</td>
      <td>2015.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>64</td>
      <td>1</td>
      <td>0.64</td>
      <td>77</td>
      <td>...</td>
      <td>6.3</td>
      <td>51.0</td>
      <td>45</td>
      <td>22.95</td>
      <td>54.0</td>
      <td>92</td>
      <td>49.68</td>
      <td>47.0</td>
      <td>52</td>
      <td>24.44</td>
    </tr>
    <tr>
      <th>2015-08-03</th>
      <td>52</td>
      <td>2015.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>72</td>
      <td>1</td>
      <td>0.72</td>
      <td>73</td>
      <td>...</td>
      <td>5.9</td>
      <td>72.0</td>
      <td>45</td>
      <td>32.40</td>
      <td>100.0</td>
      <td>92</td>
      <td>92.00</td>
      <td>67.0</td>
      <td>52</td>
      <td>34.84</td>
    </tr>
    <tr>
      <th>2015-08-04</th>
      <td>81</td>
      <td>2015.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>90</td>
      <td>1</td>
      <td>0.9</td>
      <td>72</td>
      <td>...</td>
      <td>8.5</td>
      <td>71.0</td>
      <td>45</td>
      <td>31.95</td>
      <td>95.0</td>
      <td>92</td>
      <td>87.40</td>
      <td>67.0</td>
      <td>52</td>
      <td>34.84</td>
    </tr>
    <tr>
      <th>2015-08-05</th>
      <td>68</td>
      <td>2015.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>79</td>
      <td>1</td>
      <td>0.79</td>
      <td>64</td>
      <td>...</td>
      <td>8.6</td>
      <td>71.0</td>
      <td>45</td>
      <td>31.95</td>
      <td>93.0</td>
      <td>92</td>
      <td>85.56</td>
      <td>66.0</td>
      <td>52</td>
      <td>34.32</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2022-06-10</th>
      <td>25</td>
      <td>2022.0</td>
      <td>6.0</td>
      <td>10.0</td>
      <td>20</td>
      <td>5.0</td>
      <td>19</td>
      <td>34</td>
      <td>6.46</td>
      <td>29</td>
      <td>...</td>
      <td>0.9</td>
      <td>65.0</td>
      <td>77</td>
      <td>50.05</td>
      <td>94.0</td>
      <td>76</td>
      <td>71.44</td>
      <td>95.0</td>
      <td>90</td>
      <td>85.50</td>
    </tr>
    <tr>
      <th>2022-06-11</th>
      <td>25</td>
      <td>2022.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>20</td>
      <td>5.0</td>
      <td>21</td>
      <td>34</td>
      <td>7.14</td>
      <td>31</td>
      <td>...</td>
      <td>0.9</td>
      <td>50.0</td>
      <td>77</td>
      <td>38.50</td>
      <td>66.0</td>
      <td>76</td>
      <td>50.16</td>
      <td>73.0</td>
      <td>90</td>
      <td>65.70</td>
    </tr>
    <tr>
      <th>2022-06-12</th>
      <td>36</td>
      <td>2022.0</td>
      <td>6.0</td>
      <td>12.0</td>
      <td>20</td>
      <td>7.2</td>
      <td>24</td>
      <td>34</td>
      <td>8.16</td>
      <td>38</td>
      <td>...</td>
      <td>0.9</td>
      <td>46.0</td>
      <td>77</td>
      <td>35.42</td>
      <td>55.0</td>
      <td>76</td>
      <td>41.80</td>
      <td>66.0</td>
      <td>90</td>
      <td>59.40</td>
    </tr>
    <tr>
      <th>2022-06-13</th>
      <td>73</td>
      <td>2022.0</td>
      <td>6.0</td>
      <td>13.0</td>
      <td>20</td>
      <td>14.6</td>
      <td>47</td>
      <td>34</td>
      <td>15.98</td>
      <td>97</td>
      <td>...</td>
      <td>0.6</td>
      <td>72.0</td>
      <td>77</td>
      <td>55.44</td>
      <td>90.0</td>
      <td>76</td>
      <td>68.40</td>
      <td>94.0</td>
      <td>90</td>
      <td>84.60</td>
    </tr>
    <tr>
      <th>2022-06-14</th>
      <td>0</td>
      <td>2022.0</td>
      <td>6.0</td>
      <td>14.0</td>
      <td>20</td>
      <td>0.0</td>
      <td>0</td>
      <td>34</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>77</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>76</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>90</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
<p>2510 rows × 99 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f4f70313-7245-4762-a049-ed525fb33743')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f4f70313-7245-4762-a049-ed525fb33743 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f4f70313-7245-4762-a049-ed525fb33743');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">)</span>
<span class="n">gtrends</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;gtrends.xlsx&#39;</span><span class="p">)</span>
<span class="o">!</span>cp gtrends.xlsx <span class="s2">&quot;/content/drive/MyDrive/ds/proyecto/dataset/&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Drive already mounted at drive; to attempt to forcibly remount, call drive.mount(&quot;drive&quot;, force_remount=True).
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Diego Bertolin, Antonella Bulla, Juan Manuel Hernandez, Agustin Staudt<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>